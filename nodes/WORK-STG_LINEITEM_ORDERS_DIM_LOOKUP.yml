steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-4dc8e401-b2b0-4927-ac57-cbff42497ae5:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: b715353e-8678-4ad5-a08c-030a084f79a8
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cc135470-9b66-43e1-87ab-2380482dda1b
                    stepCounter: 6cbd16e1-50e3-4ff6-93fe-d9e19d9cfbac
                transform: ""
          - columnReference:
              columnCounter: 64901c3d-cc01-41ee-a4b5-0c10c9d01cef
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 79a99c0d-f7f9-4dc1-bdcf-8263786aa7a2
                    stepCounter: a0699cab-cc29-4c4b-be73-c9e6c4bdd2bb
                transform: ""
          - columnReference:
              columnCounter: ece817e6-eb8e-42c0-9ebe-395ca4a8c897
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2c0ed5e9-83b7-4d82-be85-951dd6126090
                    stepCounter: 4871175c-a8db-46d4-a03f-4ae001110cbb
                transform: ""
          - columnReference:
              columnCounter: 158a7999-63a0-49b5-96dc-83161df226ef
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 18648c01-462c-4357-87aa-06bf781b1c16
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: 7a20ddef-4694-43c0-bb2f-166e224c1195
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0ac8b981-59fa-4d79-9750-d2164e50d1ad
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: a2ce78da-850e-45d9-875f-0f307c0c5391
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8aeab694-b4c5-4ad3-bf4b-0d40ed52e489
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: 4d5fe4df-bc33-4aa2-89f6-1822a2c7bdc0
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: fa5665c3-90d0-4a91-8235-3dd4cf55c0c1
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: 61e432a3-3c37-45f0-aceb-aef0c588f455
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3bc3bd54-5b98-4298-a193-c9309899f3a3
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: 192dbcd1-9c94-4076-8aaf-95c87eeb1d01
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 09968f12-06fc-4deb-a637-559352571f7b
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: 2ad97fa2-54fb-4f24-8d85-33da04e721ca
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b6d5f7c9-40cb-4b07-bda5-a60009357738
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: aa70d020-465d-48be-9069-8e2c032b4182
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 19929d8a-81e0-47fe-ac36-78bbd9fa6104
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: e03c04da-e609-4c14-9d44-7a65a6c58e7e
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f0e0a658-2758-4eae-b94a-63cb6eb68386
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: b585609c-1aa4-49e0-81a8-50de5428347d
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8723943d-5df4-49d3-9383-53cfc02e1448
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: 28c49d57-0d11-4f0e-b077-6ec025d6aef9
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d0cd765c-fe40-41a7-98e3-09a138ef8ffb
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: 50868b1c-5f14-4040-92a1-06fb5316d3b7
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7b74ac48-6c70-41a8-8f3e-234b7b3fbf97
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: 74ebfcf3-0539-4b5d-b409-9ba743fa589e
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2e0455c6-90da-4705-a131-a05a05cb55ae
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: d8ace2b9-f887-4e6e-9585-de9494539461
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 44131e8c-581f-487e-bd72-267aea62fe7c
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: e2d2aeda-6c60-4679-9867-1b627064fadc
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ff3fd01f-ad2b-4f65-8416-2bb7315326be
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: 80f9ed90-b324-4095-bba7-66abbe2e6945
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1e36c930-31f9-497e-969e-07aa667abd79
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: c06d5294-5d15-4ac7-b00e-0d294e4c04ab
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 62913f17-8f1b-445d-9e44-e0f5e0370086
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: c3125353-2732-4934-9327-d71ca0542be1
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ac232a2d-954a-4bc9-b74f-3973e2687d80
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: 0184a10e-35af-4667-88dd-821f277b2ff4
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f2bb61fd-c9ee-4739-9c53-035c58a99630
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: abb70e38-0a64-4396-9aaf-c487192ef19f
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a997047c-f706-4ab0-a2bb-c3f0ab80acdb
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: eed29c15-e093-4ca5-9245-888abd3c7e75
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 75285adc-e863-40b5-a8cc-4e30f7358d2b
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: 30b5d9d1-2fc1-4484-bd64-23ce32e76adb
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ea2d695f-de8c-4b2d-813b-34b3358c3099
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: 1ba98e69-59ba-4191-8cb9-8f20fcbe7555
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d470b383-8385-418b-9d67-e80a3f98245d
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: c344e5bd-765c-4ba0-9696-df1d80c4a566
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1d5bc9df-7886-4ed9-886c-e3069ae7ddb2
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: 5fb7284b-4a24-4bd7-98d9-1e97b90d3830
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1cdd399c-d868-431d-9c5c-c578406e200a
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: 7d03ab0e-260c-41d2-b6e0-e6afdee5844c
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 81c275ff-f916-424f-b61c-aa1c322bf6e4
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - columnReference:
              columnCounter: 42f45dcc-8400-4dff-a50c-e78e93306998
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: DAYS TO SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e165debb-714e-42b4-8d1b-48f39615c078
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 42f68342-e985-48c3-a9be-c77b21fbf6e3
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 84fd7a94-7235-4c17-8dad-a66f8859b517
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 2c82a938-7b63-45aa-b9cf-bdb1f587bc2e
              stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5c87be3a-3385-447c-b103-904533169149
                    stepCounter: a249af9d-e9cf-4cc1-b125-e09829392500
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: 6cbd16e1-50e3-4ff6-93fe-d9e19d9cfbac
              DIM_PART: a0699cab-cc29-4c4b-be73-c9e6c4bdd2bb
              DIM_SUPPLIER: 4871175c-a8db-46d4-a03f-4ae001110cbb
              STG_LINEITEM_ORDERS: a249af9d-e9cf-4cc1-b125-e09829392500
              STG_PARTSUPP: 9eedffeb-82e1-43eb-960c-ad0b7d6a26d6
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_LINEITEM_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"

                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"

                ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"

                AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"

                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */

                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"

                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"

                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"

                ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"

                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"

                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND

                "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 4dc8e401-b2b0-4927-ac57-cbff42497ae5
